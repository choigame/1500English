<!-- (<br>\w+)<br>\s+(<br>\w+)<br>\s+(.+) -->
<!-- {word: "$1", types: "$2", mean: "$3"}, -->

<!DOCTYPE html>
<html>
<head>
  <title>LPTD 1</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular-sanitize.js"></script>

  <script src = "https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>
</head>


<body ng-app="myApp">
    <div ng-controller="ctrl" class="container mt-4">
    <h4 class="mb-4">LPTD CD1</h4>
    	<a href="../../index.html" class="mt-2">Home</a>
    	<a href="../cd1/1.html" class="mt-2">Lptd CD1</a>
    	<a href="../cd2/2.html" class="mt-2">Lptd CD2</a>
    	<p class="my-3"></p>
    	<button class="btn btn-sm btn-info mr-3" ng-click="playFullSound()">{{bPlayingFull ? 'Stop' : 'Play'}}</button>

    	<span ng-show="bPlayingFull">
    		<button class="btn btn-sm btn-info mr-3" ng-click="pauseSound()">{{bPause ? 'Resume' : 'Pause'}}</button>
    		<button class="btn btn-sm btn-info mr-3" ng-click="backSound(-5)">-5s</button>
    		<button class="btn btn-sm btn-info mr-3" ng-click="backSound(5)">+5s</button>
    	</span>

    	

		<div class="card mt-4">
		    <div class="card-body">
	          <div class="card-text my-2">
	          	<!-- <p ng-repeat="(index, sentence) in story.en" ng-if="bShowVi" ng-click="playSentence(index)">{{sentence}}</p> -->
	          	<p ng-bind-html="story.enShow"></p>
	        <!--   	
	        	<div class="mt-5"  ng-if="story.voca">
	          		<hr/>
	          		<p ng-bind-html="story.voca"></p>
	          	</div>
	          	 -->
	          	
	          </div> <!-- card-text -->
        	</div> 		<!-- card-body -->
		 </div> <!-- card -->
    </div> <!-- container -->
</body>

<script type="text/javascript">
    var app = angular.module("myApp", ['ngSanitize']);
    app.controller("ctrl", function($scope, $timeout) {

    $scope.stories = [
{
	en: "Oh, I cannot explain<br>\
Every time it's the same<br>\
Oh, I feel that it's real<br>\
Take my heart<br>\
I've been lonely too long<br>\
Oh, I can't be so strong<br>\
Take the chance for romance<br>\
Take my heart<br>\
I need you so<br>\
There's no time I'll ever go<br>\
<br>\
Cheri, cheri lady<br>\
Goin' through a motion<br>\
Love is where you find it<br>\
Listen to your heart<br>\
Cheri, cheri lady<br>\
Living in devotion<br>\
It's always like the first time<br>\
Let me take a part<br>\
Cheri, cheri lady<br>\
Like there's no tomorrow<br>\
Take my heart, don't lose it<br>\
Listen to your heart<br>\
Cheri, cheri lady<br>\
To know you is to love you<br>\
If you call me baby<br>\
I'll be always yours<br>\
<br>\
I get up, I get down<br>\
All my world turns around<br>\
Who is right? Who was wrong?<br>\
I don't know<br>\
I've got pain in my heart<br>\
Got a love in my soul<br>\
Easy come, but I think<br>\
Easy go<br>\
I need you so<br>\
All the times I move so slow<br>\
<br>\
Cheri, cheri lady<br>\
Goin' through a motion<br>\
Love is where you find it<br>\
Listen to your heart<br>\
Cheri, cheri lady<br>\
Living in devotion<br>\
It's always like the first time<br>\
Let me take a part<br>\
Cheri, cheri lady<br>\
Like there's no tomorrow<br>\
Take my heart, don't lose it<br>\
Listen to your heart<br>\
Cheri, cheri lady<br>\
To know you is to love you<br>\
If you call me baby<br>\
I'll be always yours<br>\
Cheri, cheri lady<br>\
Like there's no tomorrow<br>\
Take my heart, don't lose it<br>\
Listen to your heart<br>\
Cheri, cheri lady<br>\
To know you is to love you<br>\
If you call me baby<br>\
I'll be yours<br>\
Cheri, cheri lady<br>\
Like there's no tomorrow<br>\
Take my heart, don't lose it<br>\
Listen to your heart<br>\
Cheri, cheri lady<br>\
To know you is to love you<br>\
If you call me baby<br>\
I'll be yours"
,
	vi: ''
},
	   ];



	$scope.range = function(min, max, step) {
	    step = step || 1;
	    var input = [];
	    for (var i = min; i <= max; i += step) {
	        input.push(i);
	    }
	    return input;
	};

	 $scope.storyIdx = 0;
	 $scope.bPlayingSentence = false;

	 $scope.bPlayingFull = false;
	 $scope.bPause = false;
	 $scope.bShowVi = 0;
	 $scope.bHiddenWords = 1;
	 $scope.audio;
	 $scope.currentTime = 0;
	 $scope.isAudioLoop = false;

  

	$scope.resetFlag = function () {
		$scope.bPlayingFull = false;
		$scope.bPause = false;
		$scope.bShowVi = 0;
		$scope.bHiddenWords = 1;
	}	

	$scope.backSound = function (sec) {
		$scope.audio.currentTime = $scope.audio.currentTime + sec;
	}

	$scope.resetAudioBtnUI = function()
	{
		$scope.bPause=false;
        $scope.bPlayingFull=false;
        if ($scope.isAudioLoop)
        {
        	$scope.playFullSound($scope.storyIdx);
        }
        $scope.$apply();
	}

	$scope.playFullSound = function (index) {
		if ($scope.bPlayingFull)
		{
			$scope.stopSound();
			$scope.bPause=false;
		}
	  	else
	  	{
	  		$scope.audio = new Audio('cherry.m4a');
		    $scope.audio.loop = false;
		    $scope.audio.play();

 			$scope.audio.addEventListener("ended", function(){
			   $scope.resetAudioBtnUI();
			});

		    $scope.bPlayingFull = true;
	  	}
	}

	$scope.pauseSound = function () {
		if (!$scope.audio) return;
		$scope.bPause = !$scope.bPause;
		if ($scope.bPause)
	    {
	    	$scope.audio.pause();
	    	$scope.currentTime = $scope.audio.currentTime;
	    }
	    else
	    {
	    	$scope.audio.currentTime = $scope.currentTime;
	    	$scope.audio.play();
	    }
	}

	$scope.stopSound = function () {
		if (!$scope.audio) return;
		 $scope.audio.pause();
		 $scope.audio.currentTime = 0;
		 $scope.currentTime = 0;
		 $scope.bPlayingFull = false;
		 $scope.bPlayingSentence = false;
	};

	$scope.fetchStory = function (idx, reset=true) {

		// when click 1.2.3..40
		if (reset==true) 
		{
			$scope.resetFlag();
			$scope.stopSound();
		}
		
		
		$scope.storyIdx = idx;
		$scope.story = $scope.stories[idx];

		//
		$scope.story.enShow = $scope.story.en;
	}


	$scope.fetchStory(0, false);

    });

</script>
</html>
