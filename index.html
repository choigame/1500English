

<!DOCTYPE html>
<html>
<head>
	<title>1500 English</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>

  <script src = "https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>

</head>


<body ng-app="myApp">
    <div ng-controller="ctrl" class="container mt-4">
    <h1 class="mb-4">1500 words</h1>
		<div class="card mt-4" ng-repeat="word in words" ng-if="false">
		    <div class="card-body">
	          <div class="card-text my-4"><span class="font-weight-bold mr-4">{{word.word}}</span>
	           	<span class="mr-4 font-italic">{{word.mean}}</span>
	           	<span class="mr-4">{{word.us}}</span>

	            <span ng-repeat="type in word.types" class="mx-1 px-2 lead"
	            ng-class="type == 'adj' ? 'bg-warning' : (type == 'adv' ? 'bg-danger' : (type == 'v' ? 'bg-success' : 'bg-info'))">{{type}}</span>

		        <button class="btn btn-primary mx-4" 
		         		 ng-click="sayIt(word.word)">
		          		<span class="glyphicon glyphicon-headphones"></span>
		      	</button>
	          </div>
	          <div class="card-text text-justify" 
	              ng-repeat="exam in word.examples"><button ng-click="sayIt(exam)" class="ml-2 btn btn-link glyphicon glyphicon-headphones"></button> {{exam}}
	          </div>
	          <a href="https://dictionary.cambridge.org/dictionary/english/{{word.word}}"
	          class="btn btn-primary mt-1 float-right"><span class="mr-4 glyphicon glyphicon-menu-right"></span>Cambridge</a>
        	</div> 		<!-- card-body -->
		 </div> <!-- card -->

		<!-- <button class="btn btn-primary my-3" ng-click="reLoadQuiz()"> Reload </button> -->
		<p class="font-weight-bold">Point:
			<span class="ml-5 text-primary">{{point}}</span> 
			<span class="ml-3" ng-if="pointClass != ''" ng-class="pointClass">{{pointClass == 'text-success' ? '+1' : '-1'}}</span> 
		</p>

		 <div>
		 	<p class="mt-2" ng-if="quiz.question.word">
		 		<span class="mb-4 mr-3 font-weight-bold" ng-click="sayIt(quiz.question.word)">{{quiz.question.word}}</span>  
		 		<span class="mb-4 mr-3">{{quiz.question.us}}</span>   
			 	<button ng-repeat="type in quiz.question.types" class="btn btn-sm mx-1"
		            ng-class="type == 'adj' ? 'bg-warning' : (type == 'adv' ? 'bg-danger' : (type == 'v' ? 'bg-success' : 'bg-info'))">{{type}}
		        </button>
		 	</p>

		 	<div class="form-check mt-4 ml-4">
		 		<div class="form-check my-3" ng-repeat="choice in quiz.choices">
				  <label class="form-check-label">
				    <input 
					    type="radio"
					    class="form-check-input" 
					    name="choices" 
					    ng-value="$index" 
					    ng-model="radioChoice"
					    ng-change="checkAnwser(choice.word);">{{choice.mean}}
				  </label>
				</div>
		 	</div> <!-- radio -->

		 	<div class="card-text my-2	" 
	              ng-repeat="exam in quiz.question.examples" ng-click="sayIt(exam)">
	              - <span wrap-in-tag word="{{quiz.question.word}}" text="{{exam}}">{{exam}}</span>
	        </div>
	          
		 </div>
    </div> <!-- container -->
</body>

<script type="text/javascript">
    var app = angular.module("myApp", []);

    app.directive('wrapInTag', function() {
		return {
	        restrict: 'A',
	        link: function(scope, ele, attr) {
	          var tag = attr.tag || 'strong';
	          var word = attr.word || [];
	          var text = attr.text || [];
	          console.log("text " + text);
	          text =  text.replace(word,'<'+tag+'>'+word+'</'+tag+'>');         
           	 ele.html(text);
	        }
	    }
	});

    app.controller("ctrl", function($scope, $timeout) {

     $scope.pointClass = '';
     $scope.quiz = {};
     $scope.point = 0;

    $scope.words = [
        {word: "additional", us: /əˈdɪʃ·ə·nəl/, types: ["adj"], mean: "bổ sung", examples: ["There will be an extra charge for any additional passengers.", "The doctor has made an initial diagnosis, but there'll be an additional examination by a specialist."]},
        {word: "admit", us: /ədˈmit/, types: ["v"], mean: "thừa nhận", examples: ["He admitted his mistake."]},
        {word: "agree", us: /əˈɡriː/, types: ["v"], mean: "đồng ý", examples: ["I agree with you on this issue."]},
        {word: "announce", us: /əˈnaʊns/, types: ["v"], mean: "thông báo", examples: ["They announced the death of their mother in the local paper.", "She announced the winner of the competition to an excited audience."]},
        {word: "apologize", us: /əˈpɑː.lə.dʒaɪz/, types: ["v"], mean: "xin lỗi", examples: ["She apologized profusely for having to leave at 3.30 p.m. "]},
        {word: "approve", us: /əˈpruːv/, types: ["v"], mean: "tán thành", examples: ["She doesn't approve of my friends.", "He doesn't approve of smoking.", "I thoroughly approve of what the government is doing."]},
        {word: "argue", us: /ˈɑːrɡ.juː/, types: ["v"], mean: "tranh luận", examples: ["The children are always arguing.","Kids, will you stop arguing with each other?"]},
        {word: "blame", us: /bleɪm/, types: ["v"], mean: "khiển trách", examples: ["Hugh blames his mother for his lack of confidence."]},
        {word: "brief", us: /briːf/, types: ["adj","adv","v"], mean: "tóm tắt", examples: ["His acceptance speech was mercifully brief.", "We had already been briefed about/on what the job would entail."]},
        {word: "brochure", us: /broʊˈʃʊr/, types: ["n"], mean: "cuốn sách nhỏ", examples: ["Enclosed is a brochure that highlights the benefits that you can receive as a corporate donor."]},
        {word: "certain", us: /ˈsɝː.tən/, types: ["adv"], mean: "chắc chắn", examples: ["The police seem certain that they will find the people responsible for the attack."]},
        {word: "comma", us: /ˈkɑː.mə/, types: ["n"], mean: "dấu phẩy", examples: ["We usually put a comma after thousands in numbers."]},
        {word: "complaint", us: /ˈkɑː.mə/, types: ["n"], mean: "lời phàn nàn", examples: ["We've received a complaint from one of our listeners about offensive language."]},
        {word: "complete", us: /kəmˈpliːt/, types: ["v"], mean: "hoàn thành", examples: ["He only needs two more cards to complete the set."]},
        {word: "conference", us: /ˈkɑːn.fɚ.əns/, types: ["n"], mean: "lời phàn nàn", examples: ["They frequently hold conferences at that hotel."]},
        {word: "confirm", us: /kənˈfɝːm/, types: ["v"], mean: "xác nhận", examples: ["Please confirm your reservation in writing by Friday."]},
        {word: "contract", us: /ˈkɑːn.trækt/, types: ["n"], mean: "hợp đồng", examples: ["Don't sign into any contract before examining its conditions carefully."]},
        {word: "contract", us: /ˈkɑːn.trækt/, types: ["v"], mean: "ký kết, làm teo(nhỏ), mắc phải", examples: ["He contracted malaria while he was travelling."]},
        {word: "convince", us: /kənˈvɪns/, types: ["v"], mean: "thuyết phục", examples: ["He managed to convince the jury of his innocence."]},
        {word: "discuss", us: /dɪˈskʌs/, types: ["v"], mean: "thảo luận", examples: ["The police want to discuss these recent racist attacks with local people."]},
        {word: "extreme", us: /ɪkˈstriːm/, types: ["adv","n"], mean: "tột/vô cùng", examples: ["In extreme cases, the disease can lead to blindness."]},
        {word: "hint", us: /hɪnt/, types: ["n"], mean: "lời gợi ý, ám chỉ", examples: ["Did she give you any hints about where she was going?"]},
	   ];

	
	$scope.stopSound = function () {
		Speech = new SpeechSynthesisUtterance();
	    window.speechSynthesis.cancel(Speech);
	};

	$scope.sayIt = function (theText) {
		Speech = new SpeechSynthesisUtterance(theText);
	    window.speechSynthesis.speak(Speech);
	};

	$scope.rdQuiz = function () {
		var rand = Math.random() *  ($scope.words.length - 1);
		return Math.floor(rand);
	};

	$scope.rdInRange = function (min, max) {
		var rand = min + Math.random() *  (max - min);
		return Math.floor(rand);
	};

	$scope.shuffle = function(array) {
	  	var currentIndex = array.length,  randomIndex;

	  // While there remain elements to shuffle.
	  while (currentIndex != 0) {

	    // Pick a remaining element.
	    randomIndex = Math.floor(Math.random() * currentIndex);
	    currentIndex--;

	    // And swap it with the current element.
	    [array[currentIndex], array[randomIndex]] = [
	      array[randomIndex], array[currentIndex]];
	  }

	  	return array;
	}

	$scope.checkAnwser = function (word) {
	 	console.log("Radio Selected Word = " + word);
	 	if ($scope.quiz.question.word == word)
	 	{
	 		$scope.point++;
	 		$scope.pointClass = 'text-success';
	 		$scope.sayIt("Perfect");
	 	}
	 	else
	 	{
	 		$scope.point--;
	 		$scope.pointClass = 'text-danger';
	 		$scope.sayIt("Wrong");
	 	}
		$scope.reLoadQuiz();
     };

     $scope.reLoadQuiz = function () {

     	$scope.stopSound();
     	$scope.quiz = {};
     	$scope.radioV = null;

     	$timeout(function() { 
	     	var rand1, rand2, rand3, rand4;
	      	rand1 = $scope.rdQuiz(0, 1);
	  		do { rand2 = $scope.rdQuiz(); } while (rand2 == rand1);
	  		do { rand3 = $scope.rdQuiz(); } while (rand3 == rand2 || rand3 == rand1);
	  		do { rand4 = $scope.rdQuiz(); } while (rand4 == rand3 || rand4 == rand2  || rand4 == rand1);
	  		var rdOrder = $scope.rdInRange(0, 3);
	  	//	console.log(rand1, rand2, rand3, rand4)
	  	//	console.log("AnwserIdx = " + rdOrder)
	  		if (rdOrder==0)
	  		{
	  			$scope.quiz.question = $scope.words[rand1];
	  			$scope.quiz.choices = [$scope.words[rand1], $scope.words[rand2], $scope.words[rand3], $scope.words[rand4]];
	  		}
	  		else if (rdOrder==1)
	  		{
	  			$scope.quiz.question = $scope.words[rand2];
	  			$scope.quiz.choices = [$scope.words[rand2], $scope.words[rand1], $scope.words[rand3], $scope.words[rand4]];
	  		}
	  		else if (rdOrder==2)
	  		{
	  			$scope.quiz.question = $scope.words[rand3];
	  			$scope.quiz.choices = [$scope.words[rand3], $scope.words[rand1], $scope.words[rand2], $scope.words[rand4]];
	  		}
	  		else if (rdOrder==3)
	  		{
	  			$scope.quiz.question = $scope.words[rand4];
	  			$scope.quiz.choices = [$scope.words[rand4], $scope.words[rand1], $scope.words[rand2], $scope.words[rand3]];
	  		}
	  		$scope.shuffle($scope.quiz.choices)
		}, 200);

    
     };

    $scope.reLoadQuiz();

    });
</script>
</html>




